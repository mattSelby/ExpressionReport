"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
" 95 CI" = paste0(round(summary(cox.model)$conf.int[[3]] ,3), "-" ,round(summary(cox.model)$conf.int[[4]],3))
)
data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"\\95 CI" = paste0(round(summary(cox.model)$conf.int[[3]] ,3), "-" ,round(summary(cox.model)$conf.int[[4]],3))
)
data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"'95' CI" = paste0(round(summary(cox.model)$conf.int[[3]] ,3), "-" ,round(summary(cox.model)$conf.int[[4]],3))
)
data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"\\95 CI" = paste0(round(summary(cox.model)$conf.int[[3]] ,3), "-" ,round(summary(cox.model)$conf.int[[4]],3))
)
data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"CI 95 CI" = paste0(round(summary(cox.model)$conf.int[[3]] ,3), "-" ,round(summary(cox.model)$conf.int[[4]],3))
)
data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"CI95CI" = paste0(round(summary(cox.model)$conf.int[[3]] ,3), "-" ,round(summary(cox.model)$conf.int[[4]],3))
)
data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"CI\\95CI" = paste0(round(summary(cox.model)$conf.int[[3]] ,3), "-" ,round(summary(cox.model)$conf.int[[4]],3))
)
data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"CI\95CI" = paste0(round(summary(cox.model)$conf.int[[3]] ,3), "-" ,round(summary(cox.model)$conf.int[[4]],3))
)
matrix(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"95 CI" = paste0(round(summary(cox.model)$conf.int[[3]] ,3), "-" ,round(summary(cox.model)$conf.int[[4]],3))
)
matrix(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3)
)
data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"95 CI" = paste0(round(summary(cox.model)$conf.int[[3]] ,3), "-" ,round(summary(cox.model)$conf.int[[4]],3))
)
data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"^95 CI" = paste0(round(summary(cox.model)$conf.int[[3]] ,3), "-" ,round(summary(cox.model)$conf.int[[4]],3))
)
data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"\^95 CI" = paste0(round(summary(cox.model)$conf.int[[3]] ,3), "-" ,round(summary(cox.model)$conf.int[[4]],3))
)
data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"\t95 CI" = paste0(round(summary(cox.model)$conf.int[[3]] ,3), "-" ,round(summary(cox.model)$conf.int[[4]],3))
)
data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"\\t95 CI" = paste0(round(summary(cox.model)$conf.int[[3]] ,3), "-" ,round(summary(cox.model)$conf.int[[4]],3))
)
data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"CI (95%)" = paste0(round(summary(cox.model)$conf.int[[3]] ,3), "-" ,round(summary(cox.model)$conf.int[[4]],3))
)
data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"CI \(95%)\" = paste0(round(summary(cox.model)$conf.int[[3]] ,3), "-" ,round(summary(cox.model)$conf.int[[4]],3))
)
data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"CI \(95%)\\" = paste0(round(summary(cox.model)$conf.int[[3]] ,3), "-" ,round(summary(cox.model)$conf.int[[4]],3))
)
data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"CI \\(95%)\\" = paste0(round(summary(cox.model)$conf.int[[3]] ,3), "-" ,round(summary(cox.model)$conf.int[[4]],3))
)
as.character("95% CI")
foo <- data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"CI" = paste0(round(summary(cox.model)$conf.int[[3]] ,3), "-" ,round(summary(cox.model)$conf.int[[4]],3))
)
colnames(foo)[3]<- as.character("95% CI")
foo
output.table <- data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"CI" = paste0(round(summary(cox.model)$conf.int[[3]] ,3), "-" ,round(summary(cox.model)$conf.int[[4]],3)),
"P value" = summary(cox.model)$coefficients[[5]]
)
output.table(foo)[3]<- as.character("95% CI")
colnames(output.table)[3]<- as.character("95% CI")
output.table
output.table <- data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"CI" = paste0(round(summary(cox.model)$conf.int[[3]] ,3), "-" ,round(summary(cox.model)$conf.int[[4]],3)),
"P value" =  round(esummary(cox.model)$coefficients[[5]], 3)
)
colnames(output.table)[3]<- as.character("95% CI")
output.table
output.table <- data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"CI" = paste0(round(summary(cox.model)$conf.int[[3]] ,3), "-" ,round(summary(cox.model)$conf.int[[4]],3)),
"P value" =  round(summary(cox.model)$coefficients[[5]], 3)
)
colnames(output.table)[3]<- as.character("95% CI")
output.table
output.table <- data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"CI" = paste0(round(summary(cox.model)$conf.int[[3]] ,3), "-" ,signif(summary(cox.model)$conf.int[[4]],3)),
"P value" =  round(summary(cox.model)$coefficients[[5]], 3)
)
colnames(output.table)[3]<- as.character("95% CI")
output.table
output.table <- data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"CI" = paste0(signif(summary(cox.model)$conf.int[[3]] ,3), "-" ,signif(summary(cox.model)$conf.int[[4]],3)),
"P value" =  signif(summary(cox.model)$coefficients[[5]], 3)
)
colnames(output.table)[3]<- as.character("95% CI")
output.table
surv.p.val
str(cox.model)
cox.model$linear.predictors
surv.p.val
ExpressionReport(gene.of.interest = "ENSG00000250305",
output.dir = "/home/shelby/for_Albert/",
expression.preferences = "/home/shelby/ExpressionReport/expressionPreferences.R",
expression.script = "/home/shelby/ExpressionReport/ExpressionReport.Rmd"
)
output.table2 <- data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"CI" = paste0(signif(summary(cox.model)$conf.int[[3]] ,3), "-" ,signif(summary(cox.model)$conf.int[[4]],3)),
"P\bvalue" =  signif(summary(cox.model)$coefficients[[5]], 3)
)
colnames(output.table2)[3]<- as.character("95% CI")
row.names(output.table2) <- "High Expression (Cont.)"
output.table2
#second half of the output table, massage as above
output.table2 <- data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"CI" = paste0(signif(summary(cox.model)$conf.int[[3]] ,3), "-" ,signif(summary(cox.model)$conf.int[[4]],3)),
"P\b\bvalue" =  signif(summary(cox.model)$coefficients[[5]], 3)
)
colnames(output.table2)[3]<- as.character("95% CI")
row.names(output.table2) <- "High Expression (Cont.)"
output.table2
output.table2 <- data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"CI" = paste0(signif(summary(cox.model)$conf.int[[3]] ,3), "-" ,signif(summary(cox.model)$conf.int[[4]],3)),
"P\tvalue" =  signif(summary(cox.model)$coefficients[[5]], 3)
)
output.table2
output.table2 <- data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"CI" = paste0(signif(summary(cox.model)$conf.int[[3]] ,3), "-" ,signif(summary(cox.model)$conf.int[[4]],3)),
"p value" =  signif(summary(cox.model)$coefficients[[5]], 3)
)
output.table2
output.table2 <- data.frame(
"n" = paste0(cox.model$nevent, "/", cox.model$n),
"HR" = round(exp(coef), 3),
"CI" = paste0(signif(summary(cox.model)$conf.int[[3]] ,3), "-" ,signif(summary(cox.model)$conf.int[[4]],3)),
"p value" =  signif(summary(cox.model)$coefficients[[5]], 3)
)
colnames(output.table2)[3,4]<- as.character("95% CI", "P value")
row.names(output.table2) <- "High Expression (Cont.)"
output.table2
as.character("95% CI", "P value")
colnames(output.table2)[3,4]<- as.character(c("95% CI", "P value"))
as.character(c("95% CI", "P value"))
colnames(output.table2)[3,4]
colnames(output.table2)[3:4]<- as.character(c("95% CI", "P value"))
output.table2
ExpressionReport(gene.of.interest = "ENSG00000250305",
output.dir = "/home/shelby/for_Albert/",
expression.preferences = "/home/shelby/ExpressionReport/expressionPreferences.R",
expression.script = "/home/shelby/ExpressionReport/ExpressionReport.Rmd"
)
ExpressionReport(gene.of.interest = "ENSG00000250305",
output.dir = "/home/shelby/for_Albert/",
expression.preferences = "/home/shelby/ExpressionReport/expressionPreferences.R",
expression.script = "/home/shelby/ExpressionReport/ExpressionReport.Rmd"
)
ExpressionReport(gene.of.interest = "ENSG00000250305",
output.dir = "/home/shelby/for_Albert/",
expression.preferences = "/home/shelby/ExpressionReport/expressionPreferences.R",
expression.script = "/home/shelby/ExpressionReport/ExpressionReport.Rmd"
)
closeAllConnections()
closeAllConnections()
ExpressionReport(gene.of.interest = "ENSG00000250305",
output.dir = "/home/shelby/for_Albert/",
expression.preferences = "/home/shelby/ExpressionReport/expressionPreferences.R",
expression.script = "/home/shelby/ExpressionReport/ExpressionReport.Rmd"
)
ExpressionReport(gene.of.interest = "ENSG00000250305",
output.dir = "/home/shelby/for_Albert/",
expression.preferences = "/home/shelby/ExpressionReport/expressionPreferences.R",
expression.script = "/home/shelby/ExpressionReport/ExpressionReport.Rmd"
)
ExpressionReport(gene.of.interest = "ENSG00000250305",
output.dir = "/home/shelby/for_Albert/",
expression.preferences = "/home/shelby/ExpressionReport/expressionPreferences.R",
expression.script = "/home/shelby/ExpressionReport/ExpressionReport.Rmd"
)
KM <-
survfit(Surv(time.os[keep.index],status.os[keep.index]) ~ gene.exp.bin, type = "kaplan-meier", conf.type = "log")
KM
plot(
KM, xlab = "Time (years)", ylab = "Cumulative Overall Survival", lwd = 2, col =
km.colours, main = title
)
# trim off any .1 from the end of ensembl IDs
gsub('\\.[0-9]+$', '', rownames(vsd)) -> gene.names
# find the gene match from the data set and get the expression for that
which(gene.of.interest == gene.names) -> gene.match
# stop if no match found
if (length(gene.match) < 1) {
stop("no gene match")
}else if (length(gene.match) > 2) {
stop("more than one gene matches")
}
# to not include NOS
if (include.nos == FALSE) {
# pull out the data and remove nos samples
annot$Group -> subgroup
which(subgroup == "NOS") -> nos.index
subgroup <- subgroup[-nos.index]
# pull out time to PFS, OS, STATUS etc.
annot$time_pfs[-nos.index] -> time.pfs
annot$time_folow_up[-nos.index] -> time.os
annot$Status_follow_up[-nos.index] -> status.os
annot$Relapse[-nos.index] -> status.pfs
# create died of disease true false vector
status.os <- status.os == "DOD"
# Progression/Relapse TRUE/FALSE vector
status.pfs <- status.pfs == "Progression" | status.pfs == "Relapse"
# gene expression
as.numeric(vsd[gene.match,-nos.index]) -> gene.exp
Index <- annot$Index[-nos.index]
# pull out NMB names
# sort out the subgroups to include
if (paste0(subgroup.include, collapse = "|") == "all") {
subgroup.data -> temp.subgroup.include
} else {
subgroup.include -> temp.subgroup.include
}
} else {
# same as above but without removing the NOS values
annot$Group -> subgroup
annot$time_pfs -> time.pfs
annot$time_folow_up -> time.os
annot$Status_follow_up -> status.os
status.os <- status.os == "DOD"
annot$Relapse -> status.pfs
status.pfs <- status.pfs == "Progression" | status.pfs == "Relapse"
as.numeric(vsd[gene.match,]) -> gene.exp
Index <- annot$Index
if (paste0(subgroup.include, collapse = "|") == "all") {
c(subgroup.data,"NOS") -> temp.subgroup.include
} else {
subgroup.include -> temp.subgroup.include
}
}
# for the log file
cat("\nSubgroups: ", temp.subgroup.include, "\n\n")
# creaste the subgroup keep index
which(subgroup %in% temp.subgroup.include) -> keep.index
### divide into two ? is this alway appropriate tertiles?
# currently hard coded to split by median but this will be changing
# get the median vsd for the gene of interest
median(gene.exp[keep.index]) -> median.gene.of.interest.vsd
# use this to assign either high or low, then make it into a factor
ifelse(gene.exp[keep.index] > median.gene.of.interest.vsd,"high","low") -> gene.exp.bin
factor(gene.exp.bin, levels = c("low","high")) -> gene.exp.bin
# this is the output for records, creates a data frame
surv.output <- data.frame(
PFS = time.pfs[keep.index],
OS = time.os[keep.index],
Status = status.os[keep.index],
Subgroup = subgroup[keep.index],
Bin = gene.exp.bin,
Exprs = gene.exp[keep.index]
)
# transpose the output and rename. just for aesthetics
surv.output <- t(surv.output)
colnames(surv.output) <- Index[keep.index]
# find out how many samples do not express, if greater than the flag value you get  a warning message
length(which(gene.exp[keep.index] == 0)) / length(gene.exp[keep.index]) -> perc.non.express
if (perc.non.express > flag.limit) {
non.exprs.flag = TRUE
}else{
non.exprs.flag = FALSE
}
if (non.exprs.flag) {
text(3,0.3, paste(
round(perc.non.express * 100,1), "% of sample \n do not express!"
), pos = 4)
}
# sort out the names
if (paste0(subgroup.include, collapse = "|") == "all") {
title <- paste("Survival for", hgnc.id)
} else {
title <-
paste0("Survival for ", hgnc.id, " (", paste0(temp.subgroup.include, collapse = ", "),")")
}
# create the Kaplan-Meier
KM <-
survfit(Surv(time.os[keep.index],status.os[keep.index]) ~ gene.exp.bin, type = "kaplan-meier", conf.type = "log")
# output flag and KM data to log file
cat("Flag Limit: ", flag.limit, "\n\n")
cat("\nKM data for: ", hgnc.id[[1]], "\n\n")
print(KM)
# plot the kaplan-meier plot
# hardcoded red blue
plot(
KM, xlab = "Time (years)", ylab = "Cumulative Overall Survival", lwd = 2, col =
km.colours, main = title
)
line(KM)
KM
gene.exp.bin
time.os
Surv(time.os[keep.index],status.os[keep.index])
KM
source("/home/shelby/ExpressionReport/expressionFrontEnd.R")
ExpressionReport(gene.of.interest = "ENSG00000106546",
output.dir = "/home/shelby/for_Bashton/",
expression.preferences = "/home/shelby/ExpressionReport/expressionPreferences.R",
expression.script = "/home/shelby/ExpressionReport/ExpressionReport.Rmd"
)
closeAllConnections()
source("/home/shelby/ExpressionReport/expressionFrontEnd.R")
#
ExpressionReport(gene.of.interest = "ENSG00000106546",
output.dir = "/home/shelby/for_Bashton/",
output.name = NULL,
expression.preferences = "/home/shelby/ExpressionReport/expressionPreferences.R",
expression.script = "/home/shelby/ExpressionReport/ExpressionReport.Rmd"
)
surv.plots
closeAllConnections()
closeAllConnections()
closeAllConnections()
surv.plots
surv.data.table<-exprSurvivalPlot(gene.of.interest,vsd,annot, hgnc.id = hgnc.id, subgroup.include = surv.plots[[i]], include.nos = include.nos, flag.limit = flag.limit, output.dirname = output.dirname, cont = surv.cont)
line(KM)
ExpressionReport(gene.of.interest = "ENSG00000106546",
output.dir = "/home/shelby/for_Bashton/",
output.name = NULL,
expression.preferences = "/home/shelby/ExpressionReport/expressionPreferences.R",
expression.script = "/home/shelby/ExpressionReport/ExpressionReport.Rmd"
)
source("/home/shelby/ExpressionReport/expressionFrontEnd.R")
#
# please just change the ensembl ID below
#
# preferences are annotated if you wanted to have a play with that
# if you want to call the files different things just add in an extra bit into output name
#
ExpressionReport(gene.of.interest = "ENSG00000135423",
output.dir = "/home/shelby/for_marie/",
output.name = NULL,
expression.preferences = "/home/shelby/ExpressionReport/expressionPreferences.R",
expression.script = "/home/shelby/ExpressionReport/ExpressionReport.Rmd"
)
ExpressionReport(gene.of.interest = "ENSG00000135423",
output.dir = "/home/shelby/for_marie/",
output.name = "Grp4",
expression.preferences = "/home/shelby/ExpressionReport/expressionPreferences.R",
expression.script = "/home/shelby/ExpressionReport/ExpressionReport.Rmd"
)
load("/home/stacey/gVizGeneMethCorr/GMset.MB.Rdata")
updateObject(load("/home/stacey/gVizGeneMethCorr/GMset.MB.Rdata"))
read.csv("/home/necs3/225_MB_Sample_Sheet.csv")
read.csv("/home/necs3/225_MB_Sample_Sheet.csv", sep = "/t")
read.csv("/home/necs3/225_MB_Sample_Sheet.csv", sep = "\t")
samp.sheet<-read.csv("/home/necs3/225_MB_Sample_Sheet.csv", sep = "\t")
head(samp.sheet)
samp.sheet<-read.csv("/home/necs3/225_MB_Sample_Sheet.csv", sep = "\t", skip = 7)
head(samp.sheet)
load("/home/stacey/gVizGeneMethCorr/samp.anno.cleaned.Rdata")
read.csv("/home/shelby/for_stacey/allMedullo450k_SampleSheet_191015.csv")
head(read.csv("/home/shelby/for_stacey/allMedullo450k_SampleSheet_191015.csv", skip = 7))
head(read.csv("/home/shelby/for_stacey/allMedullo450k_SampleSheet_191015.csv", skip = 8))
sample.sheet <- read.csv("/home/shelby/for_stacey/allMedullo450k_SampleSheet_191015.csv", skip = 8)
load("/home/stacey/gVizGeneMethCorr/samp.anno.cleaned.RData")
load("/home/stacey/gVizGeneMethCorr/samp.anno.cleaned.Rdata")
head(samp.anno.cleaned)
head(sample.sheet)
colnames(samp.anno.cleaned)[1]
colnames(samp.anno.cleaned)[1] <- "Sample_Name"
head(samp.anno.cleaned)
head(sample.sheet)
full.sheet <- merge(samp.anno.cleaned, sample.sheet)
full.sheet
sample.sheet$Sample_Name %in% samp.anno.cleaned$Sample_Name
sample.sheet$Sample_Name[sample.sheet$Sample_Name %in% samp.anno.cleaned$Sample_Name]
sample.sheet$Sample_Name[!sample.sheet$Sample_Name %in% samp.anno.cleaned$Sample_Name]
head(samp.anno.cleaned)
head(sample.sheet)
View(full.sheet)
!sample.sheet$Sample_Name %in% samp.anno.cleaned$Sample_Name
sample.sheet$Sample_Name[sample.sheet$Sample_Name %in% samp.anno.cleaned$Sample_Name]
samp.anno.cleaned$Sample_Name %in% full.sheet$Sample_Name
samp.anno.cleaned$Sample_Name[samp.anno.cleaned$Sample_Name %in% full.sheet$Sample_Name]
samp.anno.cleaned$Sample_Name[!samp.anno.cleaned$Sample_Name %in% full.sheet$Sample_Name]
paste0("NMB898"  ,   "NMB905"   ,  "NMB907"    , "NMB908"   ,  "NMB910", collapse = "|"  )
paste("NMB898"  ,   "NMB905"   ,  "NMB907"    , "NMB908"   ,  "NMB910", collapse = "|"  )
paste0(c("NMB898"  ,   "NMB905"   ,  "NMB907"    , "NMB908"   ,  "NMB910"), collapse = "|"  )
grep(paste0(c("NMB898"  ,   "NMB905"   ,  "NMB907"    , "NMB908"   ,  "NMB910"), collapse = "|"  ), sample.sheet$Sample_Name)
sample.sheet$Sample_Name[grep(paste0(c("NMB898"  ,   "NMB905"   ,  "NMB907"    , "NMB908"   ,  "NMB910"), collapse = "|"  ), sample.sheet$Sample_Name)]
gsub(pattern = "-2", replacement = "", sample.sheet$Sample_Name[grep(paste0(c("NMB898","NMB905","NMB907","NMB908","NMB910"), collapse = "|"  ), sample.sheet$Sample_Name)])
sample.sheet$Sample_Name[grep(paste0(c("NMB898","NMB905","NMB907","NMB908","NMB910"), collapse = "|"  )
, sample.sheet$Sample_Name)
sample.sheet$Sample_Name[grep(paste0(c("NMB898","NMB905","NMB907","NMB908","NMB910"), collapse = "|"  ), sample.sheet$Sample_Name)]
sample.sheet$Sample_Name[grep(paste0(c("NMB898","NMB905","NMB907","NMB908","NMB910"), collapse = "|"  ), sample.sheet$Sample_Name)]
sample.sheet$Sample_Name[grep(paste0(c("NMB898","NMB905","NMB907","NMB908","NMB910"), collapse = "|"  ), sample.sheet$Sample_Name)]<-gsub(pattern = "-2", replacement = "", sample.sheet$Sample_Name[grep(paste0(c("NMB898","NMB905","NMB907","NMB908","NMB910"), collapse = "|"  ), sample.sheet$Sample_Name)])
as.character(sample.sheet$Sample_Name[grep(paste0(c("NMB898","NMB905","NMB907","NMB908","NMB910"), collapse = "|"  ), sample.sheet$Sample_Name)])
as.character(sample.sheet$Sample_Name)
as.character(sample.sheet$Sample_Name)[grep(paste0(c("NMB898","NMB905","NMB907","NMB908","NMB910"), collapse = "|"  ), sample.sheet$Sample_Name)])
sample.sheet$Sample_Name <- as.character(sample.sheet$Sample_Name)
sample.sheet$Sample_Name[sample.sheet$Sample_Name %in% samp.anno.cleaned$Sample_Name]
sample.sheet$Sample_Name[grep(paste0(c("NMB898","NMB905","NMB907","NMB908","NMB910"), collapse = "|"  ), sample.sheet$Sample_Name)]<-gsub(pattern = "-2", replacement = "", sample.sheet$Sample_Name[grep(paste0(c("NMB898","NMB905","NMB907","NMB908","NMB910"), collapse = "|"  ), sample.sheet$Sample_Name)])
full.sheet <- merge(samp.anno.cleaned, sample.sheet)
samp.anno.cleaned$Sample_Name[!samp.anno.cleaned$Sample_Name %in% full.sheet$Sample_Name]
sample.sheet$Sample_Name
sample.sheet <- read.csv("/home/shelby/for_stacey/allMedullo450k_SampleSheet_191015.csv", skip = 8)
grep(paste0(c("NMB898","NMB905","NMB907","NMB908","NMB910"), collapse = "|"  ), sample.sheet$Sample_Name)
sample.sheet$Sample_Name[grep(paste0(c("NMB898","NMB905","NMB907","NMB908","NMB910"), collapse = "|"  ), sample.sheet$Sample_Name)]
gsub(pattern = "-2", replacement = "", sample.sheet$Sample_Name[grep(paste0(c("NMB898","NMB905","NMB907","NMB908","NMB910"), collapse = "|"  ), sample.sheet$Sample_Name)])
sample.sheet$Sample_Name[grep(paste0(c("NMB898","NMB905","NMB907","NMB908","NMB910"), collapse = "|"  ), sample.sheet$Sample_Name)]<-gsub(pattern = "-2", replacement = "", sample.sheet$Sample_Name[grep(paste0(c("NMB898","NMB905","NMB907","NMB908","NMB910"), collapse = "|"  ), sample.sheet$Sample_Name)])
sample.sheet$Sample_Name <- as.character(sample.sheet$Sample_Name)
sample.sheet$Sample_Name[grep(paste0(c("NMB898","NMB905","NMB907","NMB908","NMB910"), collapse = "|"  ), sample.sheet$Sample_Name)]<-gsub(pattern = "-2", replacement = "", sample.sheet$Sample_Name[grep(paste0(c("NMB898","NMB905","NMB907","NMB908","NMB910"), collapse = "|"  ), sample.sheet$Sample_Name)])
sample.sheet$Sample_Name[grep(paste0(c("NMB898","NMB905","NMB907","NMB908","NMB910"), collapse = "|"  ), sample.sheet$Sample_Name)]
sample.sheet$Sample_Name <- as.character(sample.sheet$Sample_Name)
grep(paste0(c("NMB898","NMB905","NMB907","NMB908","NMB910"), collapse = "|"  ), sample.sheet$Sample_Name)
sample.sheet <- read.csv("/home/shelby/for_stacey/allMedullo450k_SampleSheet_191015.csv", skip = 8)
sample.sheet$Sample_Name <- as.character(sample.sheet$Sample_Name)
grep(paste0(c("NMB898","NMB905","NMB907","NMB908","NMB910"), collapse = "|"  ), sample.sheet$Sample_Name)
sample.sheet$Sample_Name <- as.character(sample.sheet$Sample_Name)
gsub(pattern = "-2", replacement = "", sample.sheet$Sample_Name[grep(paste0(c("NMB898","NMB905","NMB907","NMB908","NMB910"), collapse = "|"  ), sample.sheet$Sample_Name)])
sample.sheet$Sample_Name[grep(paste0(c("NMB898","NMB905","NMB907","NMB908","NMB910"), collapse = "|"  ), sample.sheet$Sample_Name)]<-
gsub(pattern = "-2", replacement = "", sample.sheet$Sample_Name[grep(paste0(c("NMB898","NMB905","NMB907","NMB908","NMB910"), collapse = "|"  ), sample.sheet$Sample_Name)])
sample.sheet$Sample_Name[grep(paste0(c("NMB898","NMB905","NMB907","NMB908","NMB910"), collapse = "|"  ), sample.sheet$Sample_Name)]
full.sheet <- merge(samp.anno.cleaned, sample.sheet)
samp.anno.cleaned$Sample_Name[!samp.anno.cleaned$Sample_Name %in% full.sheet$Sample_Name]
write.csv(x = full.sheet, file = "/home/stacey/gVizGeneMethCorr/new.samp.sheet.csv")
write.csv(x = full.sheet, file = "/home/shelby/for_stacey/new.samp.sheet.csv")
head(samp.anno.cleaned)
samp.anno.cleaned
full.sheet
rep("cerebellum", 17)
samp.anno.cleaned
load("/home/stacey/Stacey_450K_Meth_Events/reprocessed_data/scripts/reprocessingScriptSamples.R")
open("/home/stacey/Stacey_450K_Meth_Events/reprocessed_data/scripts/reprocessingScriptSamples.R")
source("/home/stacey/Stacey_450K_Meth_Events/reprocessed_data/scripts/reprocessingScriptSamples.R")
library(minfi)
readRDs("/home/stacey/Stacey_450K_Meth_Events/reprocessed_data/08_01_2016/GenomicMethylSetNormalCerebellar.rds")
readRDS("/home/stacey/Stacey_450K_Meth_Events/reprocessed_data/08_01_2016/GenomicMethylSetNormalCerebellar.rds")
methlCB<- readRDS("/home/stacey/Stacey_450K_Meth_Events/reprocessed_data/08_01_2016/GenomicMethylSetNormalCerebellar.rds")
GenomicMethylSet(methlCB)
cpgCollapse(methlCB)
test <- cpgCollapse(methlCB)
rm(test)
colnames(methlCB)
colData(methlCB)
source('~/.active-rstudio-document')
colData(methlCB)$Sample_Data
colData(methlCB)
colData(methlCB)$Sample_Name
colnames(methlCB) <- colData(methlCB)$Sample_Name
methlCB
colData(methlCB)
head(sample.sheet)
grep("D283", sample.sheet$Sample_Name)
load("~/450k.data/rin.450k.meth.Rdata")
source("expressionFrontEnd.R")
ExpressionReport("ENSG00000141510",
output.dir = "~/",
expression.preferences = "expressionPreferences.R",
expression.script = "ExpressionReport.Rmd")
ExpressionReport("ENSG00000141510",
output.dir = "~/",
expression.preferences = "expressionPreferences.R",
expression.script = "ExpressionReport.Rmd")
